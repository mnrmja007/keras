# keras

# Accuracy for the smallest error is lower than the accuracy after the last epoch.
# Epoch 16/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9933Epoch 00015: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0219 - acc: 0.9932 - val_loss: 0.0650 - val_acc: 0.9851
# Epoch 10/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0476 - acc: 0.9848Epoch 00008: val_loss improved from 0.06168 to 0.05591, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0475 - acc: 0.9849 - val_loss: 0.0559 - val_acc: 0.9837

# How val_acc can be higher with higher error? Weird.
# PS. Same results using metrics = ['accuracy']
# Contact me at wor@kth.se if you can help!
# Thanks!

# Epoch 1/20
32800/33600 [============================>.] - ETA: 0s - loss: 0.6106 - acc: 0.8120Epoch 00000: val_loss improved from inf to 0.18105, saving model to ./best_checkpoint
33600/33600 [==============================] - 3s - loss: 0.6038 - acc: 0.8141 - val_loss: 0.1810 - val_acc: 0.9432
# Epoch 2/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.2277 - acc: 0.9335Epoch 00001: val_loss improved from 0.18105 to 0.11391, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.2268 - acc: 0.9338 - val_loss: 0.1139 - val_acc: 0.9660
# Epoch 3/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.1472 - acc: 0.9571Epoch 00002: val_loss improved from 0.11391 to 0.07785, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.1464 - acc: 0.9573 - val_loss: 0.0779 - val_acc: 0.9762
# Epoch 4/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.1121 - acc: 0.9668Epoch 00003: val_loss improved from 0.07785 to 0.07156, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.1116 - acc: 0.9669 - val_loss: 0.0716 - val_acc: 0.9785
# Epoch 5/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0867 - acc: 0.9738Epoch 00004: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0873 - acc: 0.9737 - val_loss: 0.0734 - val_acc: 0.9760
# Epoch 6/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0771 - acc: 0.9768Epoch 00005: val_loss improved from 0.07156 to 0.06883, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0770 - acc: 0.9769 - val_loss: 0.0688 - val_acc: 0.9793
# Epoch 7/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0617 - acc: 0.9808Epoch 00006: val_loss improved from 0.06883 to 0.06441, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0615 - acc: 0.9810 - val_loss: 0.0644 - val_acc: 0.9810
# Epoch 8/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0513 - acc: 0.9839Epoch 00007: val_loss improved from 0.06441 to 0.06168, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0511 - acc: 0.9840 - val_loss: 0.0617 - val_acc: 0.9823
# Epoch 9/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0476 - acc: 0.9848Epoch 00008: val_loss improved from 0.06168 to 0.05591, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0475 - acc: 0.9849 - val_loss: 0.0559 - val_acc: 0.9837
# Epoch 10/20
32800/33600 [============================>.] - ETA: 0s - loss: 0.0402 - acc: 0.9867Epoch 00009: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0404 - acc: 0.9866 - val_loss: 0.0615 - val_acc: 0.9831
# Epoch 11/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0346 - acc: 0.9884Epoch 00010: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0349 - acc: 0.9883 - val_loss: 0.0619 - val_acc: 0.9826
# Epoch 12/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0299 - acc: 0.9904Epoch 00011: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0299 - acc: 0.9904 - val_loss: 0.0618 - val_acc: 0.9833
# Epoch 13/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0268 - acc: 0.9912Epoch 00012: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0266 - acc: 0.9913 - val_loss: 0.0680 - val_acc: 0.9837
# Epoch 14/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0279 - acc: 0.9911Epoch 00013: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0277 - acc: 0.9911 - val_loss: 0.0689 - val_acc: 0.9831
# Epoch 15/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0263 - acc: 0.9918Epoch 00014: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0261 - acc: 0.9918 - val_loss: 0.0633 - val_acc: 0.9842
# Epoch 16/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9933Epoch 00015: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0219 - acc: 0.9932 - val_loss: 0.0650 - val_acc: 0.9851
# Epoch 17/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0235 - acc: 0.9924Epoch 00016: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0235 - acc: 0.9924 - val_loss: 0.0710 - val_acc: 0.9824
# Epoch 18/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0195 - acc: 0.9938Epoch 00017: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0197 - acc: 0.9937 - val_loss: 0.0669 - val_acc: 0.9837
# Epoch 19/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0206 - acc: 0.9938Epoch 00018: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0206 - acc: 0.9937 - val_loss: 0.0821 - val_acc: 0.9823
# Epoch 20/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0188 - acc: 0.9942Epoch 00019: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0187 - acc: 0.9942 - val_loss: 0.0803 - val_acc: 0.9819
7400/8400 [=========================>....] - ETA: 0sAccuracy: [0.080349271451788287, 0.98190472665287198]
Loaded the best model
Evaluation in progress:
7400/8400 [=========================>....] - ETA: 0sAccuracy: [0.055910060026993356, 0.98369043497812181]



