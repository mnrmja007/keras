# keras

# Accuracy for the smallest error is lower than the accuracy after the last epoch.
# Epoch 16/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0216 - acc: 0.9933Epoch 00015: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0219 - acc: 0.9932 - val_loss: 0.0650 - val_acc: 0.9851
# Epoch 9/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0476 - acc: 0.9848Epoch 00008: val_loss improved from 0.06168 to 0.05591, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0475 - acc: 0.9849 - val_loss: 0.0559 - val_acc: 0.9837

# How val_acc can be higher with higher error? Weird.
# PS. Same results using metrics = ['accuracy']
# Contact me at wor@kth.se if you can help!
# Thanks!

# Epoch 1/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.6032 - acc: 0.8142Epoch 00000: val_loss improved from inf to 0.14276, saving model to ./best_checkpoint
33600/33600 [==============================] - 3s - loss: 0.5972 - acc: 0.8161 - val_loss: 0.1428 - val_acc: 0.9563
# Epoch 2/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.1953 - acc: 0.9426Epoch 00001: val_loss improved from 0.14276 to 0.09296, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.1945 - acc: 0.9427 - val_loss: 0.0930 - val_acc: 0.9704
# Epoch 3/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.1316 - acc: 0.9605Epoch 00002: val_loss improved from 0.09296 to 0.07255, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.1310 - acc: 0.9607 - val_loss: 0.0725 - val_acc: 0.9786
# Epoch 4/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.1021 - acc: 0.9690Epoch 00003: val_loss improved from 0.07255 to 0.06834, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.1018 - acc: 0.9691 - val_loss: 0.0683 - val_acc: 0.9782
# Epoch 5/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0845 - acc: 0.9743Epoch 00004: val_loss improved from 0.06834 to 0.06342, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0841 - acc: 0.9744 - val_loss: 0.0634 - val_acc: 0.9802
# Epoch 6/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0704 - acc: 0.9783Epoch 00005: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0705 - acc: 0.9782 - val_loss: 0.0637 - val_acc: 0.9813
# Epoch 7/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0631 - acc: 0.9805Epoch 00006: val_loss improved from 0.06342 to 0.06118, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0627 - acc: 0.9806 - val_loss: 0.0612 - val_acc: 0.9820
# Epoch 8/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0523 - acc: 0.9835Epoch 00007: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0521 - acc: 0.9837 - val_loss: 0.0644 - val_acc: 0.9817
# Epoch 9/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0459 - acc: 0.9859Epoch 00008: val_loss improved from 0.06118 to 0.05864, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0457 - acc: 0.9860 - val_loss: 0.0586 - val_acc: 0.9836
# Epoch 10/20
33200/33600 [============================>.] - ETA: 0s - loss: 0.0429 - acc: 0.9867Epoch 00009: val_loss improved from 0.05864 to 0.05784, saving model to ./best_checkpoint
33600/33600 [==============================] - 2s - loss: 0.0429 - acc: 0.9866 - val_loss: 0.0578 - val_acc: 0.9833
# Epoch 11/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0387 - acc: 0.9875Epoch 00010: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0385 - acc: 0.9876 - val_loss: 0.0629 - val_acc: 0.9827
# Epoch 12/20
32800/33600 [============================>.] - ETA: 0s - loss: 0.0306 - acc: 0.9904Epoch 00011: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0306 - acc: 0.9904 - val_loss: 0.0647 - val_acc: 0.9832
# Epoch 13/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0277 - acc: 0.9905Epoch 00012: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0277 - acc: 0.9905 - val_loss: 0.0642 - val_acc: 0.9831
# Epoch 14/20
32800/33600 [============================>.] - ETA: 0s - loss: 0.0310 - acc: 0.9902Epoch 00013: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0309 - acc: 0.9903 - val_loss: 0.0635 - val_acc: 0.9839
# Epoch 15/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0271 - acc: 0.9908Epoch 00014: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0271 - acc: 0.9908 - val_loss: 0.0629 - val_acc: 0.9832
# Epoch 16/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0265 - acc: 0.9913Epoch 00015: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0269 - acc: 0.9913 - val_loss: 0.0711 - val_acc: 0.9832
# Epoch 17/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0233 - acc: 0.9928Epoch 00016: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0231 - acc: 0.9929 - val_loss: 0.0720 - val_acc: 0.9825
# Epoch 18/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0241 - acc: 0.9927Epoch 00017: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0242 - acc: 0.9926 - val_loss: 0.0681 - val_acc: 0.9842
# Epoch 19/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0217 - acc: 0.9934Epoch 00018: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0215 - acc: 0.9935 - val_loss: 0.0692 - val_acc: 0.9849
# Epoch 20/20
33000/33600 [============================>.] - ETA: 0s - loss: 0.0190 - acc: 0.9934Epoch 00019: val_loss did not improve
33600/33600 [==============================] - 2s - loss: 0.0192 - acc: 0.9934 - val_loss: 0.0741 - val_acc: 0.9840


7800/8400 [==========================>...] - ETA: 0s
# Accuracy: [0.074093488843313279, 0.98404757039887569]
Loaded the best model
Evaluation in progress:
7400/8400 [=========================>....] - ETA: 0s
# Accuracy: [0.057841272315099126, 0.9833332853657859]


